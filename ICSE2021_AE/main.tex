\documentclass[10pt,conference]{IEEEtran}

\usepackage{adjustbox}
\usepackage{booktabs}

\usepackage{listings}
\usepackage{epsfig}
\usepackage{url}
\usepackage{cite}
\usepackage{fancybox}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{tikz}
\usepackage{multirow}
\usepackage{balance}
\usepackage{graphicx}
\usepackage{pdfpages}
\usepackage{subfig}
\usepackage[hidelinks]{hyperref}
\usepackage{xcolor}
\usepackage[ruled,linesnumbered]{algorithm2e}
\usepackage[para,online,flushleft]{threeparttable}
\usepackage{xspace}
\usepackage[scaled]{beramono}
\usepackage[T1]{fontenc}



\usepackage[english]{babel} % handle hyphenation

\usepackage{amssymb}
\usepackage{ulem}
\normalem

\lstset{
%numbers=left,
%frame=single,
%language=C,
basicstyle=\fontfamily{fvm}\scriptsize,
showlines=true
%xleftmargin=.2\textwidth, xrightmargin=.2\textwidth,
}

\newcommand{\tool}{\textsf{Abacus}}

\begin{document}

\title{\tool{}: A Tool for Precise Side-channel Analysis}
\author{\IEEEauthorblockN{
Qinkun Bao\IEEEauthorrefmark{1},
Zihao Wang\IEEEauthorrefmark{1},
James R. Larus\IEEEauthorrefmark{2}, and
Dinghao Wu\IEEEauthorrefmark{1}}
\IEEEauthorblockA{\IEEEauthorrefmark{1}The Pennsylvania State University}
\IEEEauthorblockA{\IEEEauthorrefmark{2}EPFL}
}


\maketitle

\begin{abstract}
Side-channel vulnerabilities can leak sensitive information unconsciously. 
In this paper, we introduce the usage of Abacus. A tool can analyze secret-dependent control-flow and secret-dependent data-access leakages in binary programs. Unlike previous tools, it can also estimate the amount of leaked information for each leakage site, which helps developers find and fix severe leakages.

This document is to help users make use of Abacus and reproduce the
results. Abacus is available at \url{https://github.com/s3team/Abacus}.
\end{abstract}


\section{Introduction}


Abacus~\cite{bao2021abacus} is an address-based side-channel vulnerabilities analyze tool. Different from previous tools, it can also give an estimation of the amount of the leaked information for each leakage site.

We quantify the amount of each leakage site based on the search space. For example, if the length of the key is 128 bits, an attacker needs to brute force $2^{128}$ possible keys without any domain knowledge. However, suppose an attacker observes some information an can reduce the size of the search space to $2^{120}$. Then we can conclude 8 bits of the information are leaked.

\section{Requirements}
We have tested ~tool{} on macOS and Ubuntu. You can refer to the continuous integration files to build Abacus on your operating system. However, we strongly recommend you to build~\tool{} in inside a container.
\begin{itemize}
\item Supported OS: Ubuntu 18.04
\item Memory: 32 GB (If you want to run experiments concurrently, update the size of RAM
     accordingly. Otherwise the program may be terminated by the system.)
\end{itemize}

\section{License}
Apache License 2.0

\section{Installation}

\subsection{Download and build the artifact}
\tool{} can be built within a docker, simply run the following command

\begin{lstlisting}[language=bash]
$ git clone https://github.com/s3team/Abacus.git
$ cd Abacus
$ ./docker.sh
\end{lstlisting}

After you build the docker image and enter the container, run the
following command to build Abacus.

\begin{lstlisting}[language=bash]
$ ./build.sh
\end{lstlisting}
\subsection{Run the hello world example}
\emph{Ensure from here on that you are in the Docker Container.}

In order to test this function with Abacus, we need to tell Abacus 
which variables are the secret data. We use the function `abacus\_make\_symbolic`. 
The function takes three arguments: the type of the symbol, the address of 
the secret, and the length of the secret input. In the example below, 
the secret input is the variable `secret`, and its length is two bytes.

\subsubsection{Build the example}

Abacus works directly on the machine instruction. Here we build it into 
a 32-bit ELF executable. Note that while Abacus can work on stripped binaries 
without the source code. However, in the example, we use debug information 
to get a more clear result.
\begin{lstlisting}[language=bash]
$ cd examples
$ gcc -m32 -g example1.c
\end{lstlisting}


\begin{figure}[tbp]

\begin{lstlisting}[frame=single, numbers = none, language=bash]
int main() {
  uint16_t secret = 6;
  char *type = "1";
  abacus_make_symbolic(type, &secret, 2); 
  is_odd(secret);
  return 0;
}
\end{lstlisting}
\caption{Secret-dependent data accesses}
\label{fig:secret:da}
\end{figure}

\subsubsection{Collect the trace}
We use the pin tool to collect the execution trace. The tool can automatically 
collect the trace and other necessary runtime information.
\begin{lstlisting}[language=bash]
$ cd /abacus/Pintools
$ make PIN_ROOT=/abacus/Intel-Pin-Archive/ TARGET=ia32
$ cd /abacus
$ /abacus/Intel-Pin-Archive/pin -t Pintools/obj-ia32/MyPinToolLinux.so \
  -- ./examples/a.out 
\end{lstlisting}

You will get two files Function.txt and Inst\_data.txt, which are 
the inputs of the Abacus.

\subsubsection{Quantify the leakage}
To run Abacus on the execution trace and get the analysis result.
\begin{lstlisting}[language=bash]

$ ./build/App/QIF/QIF ./Inst_data.txt -f Function.txt \ 
  -d ./examples/a.out -o result.txt
\end{lstlisting}


\section{Analyze Cryptography Function}
The results (Table II in the accepted paper) in the evaluation section can be 
verified by running the simple command after you build Abacus successfully in 
the docker (step 1). We have prepared scripts to test each crypto algorithm 
automatically.

For example, if you want to test AES in mbedTLS 2.5, you can try the 
following command.

\begin{lstlisting}[language=bash]
$ cd /abacus/script/AES_MBEDTLS_2.5
$ ./start.sh
\end{lstlisting}
\section*{Acknowledgment}
We thank anonymous reviewers for their valuable feedback. The work was supported in part by the National Science Foundation (NSF) under grant CNS-1652790, and the Office of Naval Research (ONR) under grants N00014-16-1-2912, N00014-16-1-2265, and N00014-17-1-2894. 



\bibliographystyle{IEEEtran}
\bibliography{refs}
\end{document}
